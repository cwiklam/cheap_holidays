<div class="w-full text-left max-w-7xl mx-auto space-y-8">
  <div class="flex items-center justify-between flex-wrap gap-4">
    <h1 class="text-3xl font-bold">Oferty (ostatnie <%= @offers.size %>)</h1>
    <div class="flex gap-2">
      <%= link_to "Powrót", root_path, class: "btn btn-sm" %>
    </div>
  </div>

  <%= form_with url: offers_path, method: :get, local: true, class: "grid md:grid-cols-5 gap-4 items-end bg-base-200 p-4 rounded" do %>
    <div>
      <label class="label" for="q">Nazwa / Hotel</label>
      <input type="text" name="q" id="q" value="<%= params[:q] %>" class="input input-bordered w-full" placeholder="np. hotel, resort"/>
    </div>
    <div>
      <label class="label" for="start">Fragment terminu</label>
      <input type="text" name="start" id="start" value="<%= params[:start] %>" class="input input-bordered w-full" placeholder="np. 9.09"/>
    </div>
    <div class="flex gap-2 pt-6 md:pt-0">
      <button class="btn btn-primary" type="submit">Filtruj</button>
      <%= link_to "Wyczyść", offers_path, class: "btn btn-ghost" %>
    </div>
  <% end %>

  <% if @offers.any? %>
    <div class="overflow-x-auto">
      <table class="table w-full">
        <thead>
        <tr>
          <th>Oferta</th>
          <th>Hotel</th>
          <th>Kraj</th>
          <th>Biuro</th>
          <th>Cena</th>
          <th>Termin</th>
          <th>Link</th>
          <th>Dodano</th>
        </tr>
        </thead>
        <tbody>
        <% @offers.each do |offer| %>
          <tr>
            <td class="max-w-xs">
              <div class="font-semibold"><%= offer.name %></div>
            </td>
            <td>
              <%= offer.hotel&.name %>
            </td>
            <td>
              <% if offer.hotel.country %>
                <span class="badge badge-outline"><%= offer.hotel.country.name %></span>
              <% end %>
            </td>
            <td>
              <% if offer.travel_agency %>
                <%= link_to offer.travel_agency.name, travel_agency_path(offer.travel_agency), class: 'link' %>
              <% end %>
            </td>
            <td>
              <% if offer.price %>
                <span class="font-medium"><%= number_with_precision(offer.price, precision: 2) %></span>
                <div class="text-xs opacity-60"><%= offer.price_raw %></div>
              <% end %>
            </td>
            <td class="text-sm"><%= offer.starts_on %></td>
            <td>
              <% if offer.url.present? %>
                <%= link_to 'Otwórz', offer.url, target: '_blank', rel: 'noopener', class: 'btn btn-xs' %>
              <% end %>
            </td>
            <td class="text-xs whitespace-nowrap" title="<%= offer.created_at %>"><%= time_ago_in_words(offer.created_at) %>
              temu
            </td>
          </tr>
        <% end %>
        </tbody>
      </table>
    </div>
  <% else %>
    <p class="opacity-70">Brak wyników dla podanych filtrów.</p>
  <% end %>

  <p class="text-xs opacity-60">Wyświetlono maksymalnie 200 najnowszych ofert. Doprecyzuj filtry aby zawęzić listę.</p>
</div>

